# Структура директорий SPA

## Обозначения

- 🔴 **Красный** — Фиксированная директория
- 🔵 **Синий** — Файл
- 🟡 **Желтый** — Директория с произвольной структурой
- 🟢 **Зеленый** — Рекурсивная директория

---

## Корневая структура

```
src/
├── core/           🟡 Ядро приложения (DI и др.)
│   └── di/         🔴 Контейнер, провайдеры, createWidget
├── components/     🟢 Рекурсивная директория
├── widgets/        🔴 Фиксированная директория для виджетов
├── shared/         🟡 Общий код: типы, utils, constants, data, модели доменов
├── layout/
└── routes/         🟢 Рекурсивная директория маршрутов приложения
```

**Распределение кода:**
- **models** — живут внутри виджетов (`widgets/*/model/`) и при необходимости в `shared/` (доменные сущности).
- **types** — в виджетах (`widgets/*/model/`, `widgets/*/components/`) и в `shared/`.
- **utils, constants, data** — переиспользуемое в `shared/`; специфичное для виджета — внутри виджета (например `widgets/*/utils/`, `widgets/*/constants/`).

---

## UI-компоненты

Переиспользуемые UI-компоненты (дизайн-система shadcn/ui) — в `src/components/ui/`. Документация по созданию и правилам: **docs/ui-components.md**. Инструкции для ИИ-агента: **.cursor/rules/ui-components.md**.

---

## Алиасы
ВСЕГДА используй алиасы вместо прямого пути.

| Алиас | Путь |
|-------|------|
| `@` | `src` |
| `@utils` | `src/utils` |
| `@components` | `src/components` |
| `@components/*` | `src/components/*` |
| `@widgets/*` | `src/widgets/*` |
| `@shared/*` | `src/shared/*` |
| `@layout` | `src/layout` |
| `@layout/*` | `src/layout/*` |
| `@routes` | `src/routes` |
| `@routes/*` | `src/routes/*` |
| `@core/*` | `src/core/*` |

## Виджеты и маршруты

### widgets

Фиксированная директория для виджетов.

**Правило:** Виджеты не могут содержать в своей директории другие виджеты, но могут использовать рядом лежащие.

```
widgets/
├── widgetA/
│   ├── components/          🟢 Рекурсивная директория
│   └── model/               🟡 ViewModels
│       ├── index.ts         🔵
│       └── ...
└── widgetB/
    ├── components/          🟢 Рекурсивная директория
    └── model/               🟡 ViewModels
        ├── index.ts         🔵
        └── ...
```

### routes

Рекурсивная директория для маршрутов приложения.

**Правило:** Максимум 2 уровня вложенности.

```
routes/
├── pageA/
│   ├── index.ts                🔵
│   ├── page.tsx                🔵
│   ├── model/                  🟡 Директория с произвольной структурой
│   │   ├── index.ts            🔵
│   │   ├── PageModel.ts        🔵
│   │   ├── ModelA.ts           🔵
│   │   ├── ModelB.ts           🔵
│   │   └── utils/              🟡 У каждой директории могут быть свои utils
│   └── components/             🟢 Рекурсивная директория
│       ├── ComponentA/
│       │   ├── index.ts        🔵
│       │   ├── ComponentA.tsx  🔵
│       │   ├── hooks/          🟡 Вся логика, связанная исключительно с DOM
│       │   └── utils/          🟡
│       ├── ComponentB/
│       └── components/         🟢 Простые компоненты можно дробить на другие более мелкие компоненты
└── pageB/
    ├── index.ts                🔵
    ├── page.tsx                🔵
    ├── model/                  🟡
    └── components/             🟢
        ├── ComponentA/
        ├── ComponentB/
        └── components/         🟢
```

**Правило для components:** Простые компоненты, которые используют модель страницы и не могут работать без вставки в компонент страницы.

**Правило использования:** Компоненты из этой директории могут использовать только на этом уровне вложенности и ниже.

### layers

Рекурсивная директория для слоев приложения.

**Правило:** Максимум 2 уровня вложенности.

```
layers/
├── layerA/
│   ├── index.ts                🔵
│   ├── layer.tsx               🔵
│   ├── model/                  🟡 Директория с произвольной структурой
│   │   ├── index.ts            🔵
│   │   ├── LayerModel.ts       🔵
│   │   ├── ModelA.ts           🔵
│   │   ├── ModelB.ts           🔵
│   │   └── utils/              🟡
│   └── components/             🟢 Рекурсивная директория
│       ├── ComponentA/
│       │   ├── index.ts        🔵
│       │   ├── ComponentA.tsx  🔵
│       │   ├── hooks/          🟡 Вся логика, связанная исключительно с DOM
│       │   └── utils/          🟡
│       ├── ComponentB/
│       └── components/         🟢
└── layerB/
    ├── index.ts                🔵
    ├── layer.tsx               🔵
    ├── model/                  🟡
    └── components/             🟢
        ├── ComponentA/
        ├── ComponentB/
        └── components/         🟢
```

**Правило для components:** Простые компоненты, которые используют модель страницы и не могут работать без вставки в компонент страницы.

**Правило использования:** Компоненты из этой директории могут использовать только на этом уровне вложенности и ниже.

---

## shared

Общий код, переиспользуемый в приложении (компоненты, утилиты, модели по доменам).

```
shared/
├── domainA/
│   ├── featureA/
│   │   ├── index.ts         🔵
│   │   ├── components/      🟢 Рекурсивная директория
│   │   ├── model/           🟡 Директория с произвольной структурой
│   │   └── widgets/         🔴 Фиксированная директория
│   └── featureB/
└── domainB/
```

---

## Общие правила

1. **У каждой директории могут быть свои utils** — вспомогательные функции могут находиться на любом уровне вложенности.

2. **Максимум 2 уровня вложенности** — для директорий `routes` и `layers`.

3. **Виджеты не могут содержать в своей директории другие виджеты**, но могут использовать рядом лежащие.

4. **Простые компоненты можно дробить на другие более мелкие компоненты** — компоненты могут содержать вложенные директории `components`.

5. **Компоненты из директории components могут использовать только на этом уровне вложенности и ниже** — ограничение на использование компонентов.

6. **ViewModels** — директория `model` в виджетах содержит ViewModels.

7. **Вся логика, связанная исключительно с DOM** — хранится в директории `hooks`.

8. **Простые компоненты, которые используют модель страницы и не могут работать без вставки в компонент страницы** — описание для компонентов в `routes` и `layers`.
